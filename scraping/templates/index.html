<html>

<title>Deck app</title>

<body>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="../static/css/styles.css">

    <div class= "d-flex flex-column align-items-center description">

        <form id="form">
            <input type="search" id="query" name="q" placeholder="Enter a url...">
            <button>Search</button>
        </form>
        <p>This site takes a url for Magic: The Gathering deck and returns the associated decklist along with other relevant data.</p>
        <p>Example: https://www.mtggoldfish.com/archetype/modern-death-s-shadow#paper</p>
        <p>Currently supported sites mtggoldfish.com</p>
    </div>

    <div class= "d-flex flex-column align-items-center description">
            <p id= "main"></p>
    </div>

    <script>
      const f = document.getElementById('form');
      const q = document.getElementById('query');
      const url = 'https://deck-scraper.herokuapp.com/names/';
      var tree = document.createDocumentFragment();

      async function submitted(event) {

        event.preventDefault()
        const response = await fetch(url + q.value);

        const responsedata = await response.json();
        const cleaneddata = responsedata.values;
        console.log(cleaneddata);


        for(x in cleaneddata){


            var div = document.createElement("div");
            div.setAttribute("id", cleaneddata[x].name);
            div.appendChild(document.createTextNode(cleaneddata[x].num + "x "));
            div.appendChild(document.createTextNode(cleaneddata[x].name));
            tree.append(div);
        }
        document.getElementById("main").appendChild(tree);
        const newdata = JSON.stringify(cleaneddata);
      }

      f.addEventListener('submit', submitted);
    </script>


</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>

</html>